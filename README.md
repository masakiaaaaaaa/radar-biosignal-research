# 非接触バイタルサイン推定：レーダーセンサーを用いた脈波伝播時間(PTT)の解析

## 📖 研究概要
本研究は、ドップラーレーダーを用いて手首の橈骨動脈の微細な振動を非接触で計測し、そのデータから心拍数(HR)や脈波伝播時間(PTT)を推定する手法を確立することを目的としています。PTTは血圧と強い相関があるため、将来的には**非接触かつ連続的な血圧モニタリング**への応用が期待されます。

**[📄 卒業論文全文 (PDF)](./Graduation_Thesis.pdf)**

## 🔑 キーテクノロジー
- **センサー**: 24GHz ドップラーレーダー
- **信号処理**: バンドパスフィルタリング、ピーク検出アルゴリズム、RMS誤差・相関係数による評価
- **データ解析**: 最小二乗法による回帰分析 (PTT推定モデル構築)
- **生体情報工学**: 心電図 (ECG)との同期計測、心拍変動 (HRV)、Bramwell-Hill式に基づく血圧推定

## 🔬 実験と結果
ECG信号を基準値とし、レーダーから得られた信号の精度を評価しました。

| ![実験セットアップ](./setup_image.png) | ![ECGとレーダー信号の相関](./correlation_graph.png) |
|:---:|:---:|
| 図1. 実験セットアップ | 図2. ECGとレーダー信号の瞬時心拍間隔の比較 |

**主な成果:**
- レーダーで計測した心拍間隔は、**基準となるECGとの相関係数が0.998**と非常に高い一致を示した。
- レーダー信号から抽出した特徴量（CT, PI）を用いた回帰分析により、**PTTを誤差3.175%で推定可能なモデルを構築**した。

## 💻 解析コード
本研究のデータ解析に使用したMATLABスクリプトの一部です。

```matlab
% --- ピーク検出 ---
[pks, locs] = findpeaks(filtered_signal, 'MinPeakHeight', 0.1, 'MinPeakDistance', 0.5*fs);

% --- PTT算出 ---
% ECGのR波ピーク(ecg_locs)と最も近いレーダー信号ピーク(radar_locs)の時間差を計算
for i = 1:length(ecg_locs)
    [~, min_idx] = min(abs(radar_locs - ecg_locs(i)));
    ptt(i) = (radar_locs(min_idx) - ecg_locs(i)) / fs;
end

% --- PTT推定モデル (回帰分析) ---
X = [ones(length(CT), 1), CT, PI]; % 説明変数
b = regress(PTT_ground_truth, X); % 未知数a,b,cを算出
PTT_estimated = X * b;
